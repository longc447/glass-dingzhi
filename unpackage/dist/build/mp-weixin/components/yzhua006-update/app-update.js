(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/yzhua006-update/app-update"],{"2b4a":function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){}));var o=function(){var t=this.$createElement,e=(this._self._c,this.downstatus<1||this.schedule?null:(this.downloadedSize/1024/1024).toFixed(2));this.$mp.data=Object.assign({},{$root:{g0:e}})},a=[]},3481:function(t,e,n){"use strict";n.r(e);var o=n("9c34"),a=n.n(o);for(var i in o)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return o[t]}))}(i);e["default"]=a.a},"614f":function(t,e,n){},"7f2f":function(t,e,n){"use strict";n.r(e);var o=n("2b4a"),a=n("3481");for(var i in a)["default"].indexOf(i)<0&&function(t){n.d(e,t,(function(){return a[t]}))}(i);n("b478");var u=n("f0c5"),d=Object(u["a"])(a["default"],o["b"],o["c"],!1,null,"5e8ff0ec",null,!1,o["a"],void 0);e["default"]=d.exports},"9c34":function(t,e,n){"use strict";(function(t){var n;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o={name:"appUpdate",props:{force:{type:Boolean,default:!0},tabbar:{type:Boolean,default:!1}},data:function(){return{popup_show:!1,platform:"",version:"1.0.0",need_update:!1,downing:!1,downstatus:0,update_info:{os:"",version:"",note:""},schedule:0,downloadedSize:0,viewObj:null}},created:function(){n=this},computed:{lengthWidth:function(){return{width:480*n.schedule/100+"rpx"}},getHeight:function(){var t=0;return n.tabbar&&(t=50),{bottom:t+"px"}}},methods:{update:function(){console.log("父组件触发方法")},getUpdateInfo:function(){t.request({url:"https://jhg.ruanjiangc.com/api/help/update",method:"get",success:function(t){console.log(t.data.data);for(var e=t.data.data,o=0;o<e.length;o++)if(n.platform==e[o]["os"]){n.update_info=e[o];break}n.update_info.os&&(console.log("后台返回的当前系统的升级参数",n.update_info),n.checkUpdate())}})},checkUpdate:function(){n.need_update=n.compareVersion(n.version,n.update_info.version),n.need_update&&(n.popup_show=!0,n.tabbar&&(n.viewObj=new plus.nativeObj.View("viewObj",{bottom:"0px",left:"0px",height:"50px",width:"100%",backgroundColor:"rgba(0,0,0,.6)"}),n.viewObj.show()))},closeUpdate:function(){n.force?"Android"==plus.os.name?plus.runtime.quit():plus.ios.import("UIApplication").sharedApplication().performSelector("exit"):(n.popup_show=!1,n.viewObj.hide())},nowUpdate:function(){if(n.downing)return!1;n.downing=!0,/\.apk$/.test(n.update_info.download_url)||/\.wgt$/.test(n.update_info.download_url)?n.download_wgt():plus.runtime.openURL(n.update_info.download_url,(function(){plus.nativeUI.toast("打开错误")}))},download_wgt:function(){plus.nativeUI.showWaiting("下载更新文件...");var t=plus.downloader.createDownload(n.update_info.download_url,{method:"get"},(function(t,e){}));t.addEventListener("statechanged",(function(t,e){if(null===e);else if(200==e)switch(n.downstatus=t.state,t.state){case 3:n.downloadedSize=t.downloadedSize;var o=0;t.totalSize&&(o=t.totalSize),n.schedule=parseInt(100*t.downloadedSize/o);break;case 4:n.installWgt(t.filename);break}else plus.nativeUI.closeWaiting(),plus.nativeUI.toast("下载出错"),n.downing=!1,n.downstatus=0})),t.start()},installWgt:function(t){plus.nativeUI.showWaiting("安装更新文件..."),plus.runtime.install(t,{},(function(){plus.nativeUI.closeWaiting(),plus.nativeUI.alert("应用资源下载完成！",(function(){plus.runtime.restart()}))}),(function(t){plus.nativeUI.closeWaiting(),plus.nativeUI.alert("安装更新文件失败["+t.code+"]："+t.message)}))},compareVersion:function(t,e){if(!t||!e||""==t||""==e)return!1;for(var n=t.split(".",4),o=e.split(".",4),a=0;a<n.length&&a<o.length;a++){var i=n[a],u=parseInt(i),d=o[a],s=parseInt(d);if(s>u||d.length>i.length)return!0;if(s<u)return!1}return o.length>n.length&&0==e.indexOf(t)}}};e.default=o}).call(this,n("543d")["default"])},b478:function(t,e,n){"use strict";var o=n("614f"),a=n.n(o);a.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/yzhua006-update/app-update-create-component',
    {
        'components/yzhua006-update/app-update-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("7f2f"))
        })
    },
    [['components/yzhua006-update/app-update-create-component']]
]);
