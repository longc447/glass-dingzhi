require('../../common/vendor.js');(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["otherpages/goods/coupon/coupon"],{"12a1":function(t,o,e){"use strict";var i=e("3b55"),n=e.n(i);n.a},"3b55":function(t,o,e){},4763:function(t,o,e){"use strict";e.r(o);var i=e("b3a9"),n=e("7a0b");for(var s in n)["default"].indexOf(s)<0&&function(t){e.d(o,t,(function(){return n[t]}))}(s);e("12a1");var u=e("f0c5"),a=Object(u["a"])(n["default"],i["b"],i["c"],!1,null,null,null,!1,i["a"],void 0);o["default"]=a.exports},"7a0b":function(t,o,e){"use strict";e.r(o);var i=e("f374"),n=e.n(i);for(var s in i)["default"].indexOf(s)<0&&function(t){e.d(o,t,(function(){return i[t]}))}(s);o["default"]=n.a},"985b":function(t,o,e){"use strict";(function(t){e("d947");i(e("66fd"));var o=i(e("4763"));function i(t){return t&&t.__esModule?t:{default:t}}wx.__webpack_require_UNI_MP_PLUGIN__=e,t(o.default)}).call(this,e("543d")["createPage"])},b3a9:function(t,o,e){"use strict";e.d(o,"b",(function(){return n})),e.d(o,"c",(function(){return s})),e.d(o,"a",(function(){return i}));var i={nsEmpty:function(){return e.e("components/ns-empty/ns-empty").then(e.bind(null,"ff23"))},loadingCover:function(){return e.e("components/loading-cover/loading-cover").then(e.bind(null,"9257"))}},n=function(){var t=this,o=t.$createElement,e=(t._self._c,t.addonIsExit.coupon?t.__map(t.list,(function(o,e){var i=t.__get_orig(o),n=t.$util.img(2==o.useState?"/upload/uniapp/coupon/bg_lingqu_gary.png":"/upload/uniapp/coupon/bg_lingqu.png"),s=o.discount&&"0.00"!=o.discount?null:parseInt(o.money),u=o.discount&&"0.00"!=o.discount&&"discount"==o.type?parseFloat(o.discount):null,a=o.validity_type?null:t.$util.timeStampTurnTime(o.end_time);return{$orig:i,g0:n,m0:s,m1:u,g1:a}})):null);t.$mp.data=Object.assign({},{$root:{l0:e}})},s=[]},f374:function(t,o,e){"use strict";(function(t){Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var i=s(e("04b1")),n=s(e("a88e"));function s(t){return t&&t.__esModule?t:{default:t}}var u={data:function(){return{couponTab:0,list:[],back:"/otherpages/goods/coupon/coupon"}},onShow:function(){var t=this;this.$langConfig.refresh(),this.addonIsExit.coupon||(this.$util.showToast({title:"优惠券未启用",mask:!0}),setTimeout((function(){t.$util.redirectTo("/pages/index/index/index",{},"redirectTo")}),1e3))},mixins:[n.default,i.default],computed:{addonIsExit:function(){return this.$store.state.addonIsExit}},methods:{liClick:function(t,o){0==t.useState?this.receiveCoupon(t,o):this.toGoodsList(t,o)},couponTabOn:function(t){this.couponTab=t,this.list=[],this.$refs.mescroll.refresh(!1)},receiveCoupon:function(o,e){var i=this;if(!this.couponBtnSwitch){this.couponBtnSwitch=!0;var n=t.getStorageSync("token");if(""!=n){var s,u={site_id:o.site_id,get_type:2};0==this.couponTab?(s="/coupon/api/coupon/receive",u.coupon_type_id=o.coupon_type_id):(s="/platformcoupon/api/platformcoupon/receive",u.platformcoupon_type_id=o.platformcoupon_type_id),this.$api.sendRequest({url:s,data:u,success:function(t){t.data;var e=t.message;0==t.code&&(e="领取成功");var n=i.list;if(0==i.couponTab)if(1==t.data.is_exist)for(var s=0;s<n.length;s++)n[s].coupon_type_id==o.coupon_type_id&&(n[s].useState=1);else for(var u=0;u<n.length;u++)n[u].coupon_type_id==o.coupon_type_id&&(n[u].useState=2);else if(1==t.data.is_exist)for(var a=0;a<n.length;a++)n[a].platformcoupon_type_id==o.platformcoupon_type_id&&(n[a].useState=1);else for(var c=0;c<n.length;c++)n[c].platformcoupon_type_id==o.platformcoupon_type_id&&(n[c].useState=2);i.$util.showToast({title:e}),i.couponBtnSwitch=!1},fail:function(t){i.couponBtnSwitch=!1}})}else this.bindgetuserinfo()}},bindgetuserinfo:function(){if(this.$util.isWeiXin()){var t="";t=this.back?i.default.h5Domain+"/pages/login/login/login?back="+encodeURIComponent(this.back):i.default.h5Domain+"/pages/login/login/login",this.$api.sendRequest({url:"/wechat/api/wechat/authcode",data:{redirect_url:t},success:function(t){t.code>=0&&(location.href=t.data)}})}else this.back?this.$util.redirectTo("/pages/login/login/login",{back:this.back}):this.$util.redirectTo("/pages/login/login/login");this.couponBtnSwitch=!1},getMemberCounponList:function(t){var o,e=this;o=0==this.couponTab?"/coupon/api/coupon/typepagelists":"/platformcoupon/api/platformcoupon/typepagelists",this.$api.sendRequest({url:o,data:{page:t.num,page_size:t.size},success:function(o){var i=[],n=o.message;0==o.code&&o.data?i=o.data.list:e.$util.showToast({title:n}),i.length&&i.forEach((function(t){t.useState=0})),t.endSuccess(i.length),i.length&&i.forEach((function(t){t.count==t.lead_count?t.useState=2:t.useState=0})),1==t.num&&(e.list=[]),e.list=e.list.concat(i),e.$refs.loadingCover&&e.$refs.loadingCover.hide()},fail:function(){t.endErr(),this.$refs.loadingCover&&this.$refs.loadingCover.hide()}})},toGoodsList:function(t){0==this.couponTab?1!=t.goods_type?this.$util.redirectTo("/otherpages/shop/list/list",{couponId:t.coupon_type_id,site_id:t.site_id}):this.$util.redirectTo("/otherpages/shop/list/list",{site_id:t.site_id}):1!=t.use_scenario?this.$util.redirectTo("/pages/goods/list/list",{platformcouponTypeId:t.platformcoupon_type_id}):this.$util.redirectTo("/pages/goods/list/list",{})}},onShareAppMessage:function(t){return{title:"送您一张优惠券,快来领取吧",path:"/otherpages/goods/coupon/coupon",success:function(t){},fail:function(t){}}}};o.default=u}).call(this,e("543d")["default"])}},[["985b","common/runtime","common/vendor"]]]);