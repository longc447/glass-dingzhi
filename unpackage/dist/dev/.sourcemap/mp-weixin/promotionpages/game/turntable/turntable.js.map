{"version":3,"sources":["uni-app:///main.js","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/turntable/turntable.vue?9418","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/turntable/turntable.vue?ea2e","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/turntable/turntable.vue?439f","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/turntable/turntable.vue?07bf","uni-app:///promotionpages/game/turntable/turntable.vue","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/turntable/turntable.vue?2159","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/turntable/turntable.vue?0753","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/turntable/turntable.vue?b598","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/turntable/turntable.vue?215e"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","uniPopup","LTime","data","token","isClick","currentIndex","maxRing","currentRing","speed","timer","id","gameInfo","award","award_img","award_name","surplus_num","noAward","resultIndex","result","is_winning","point","animate","scrollTimer","siteId","onLoad","option","onShow","title","mask","setTimeout","mixins","computed","storeToken","watch","methods","redirectToRecord","getMemberPointInfo","url","account_type","success","lottery","site_id","fail","getGameInfo","res","startRoll","clearInterval","showResult","closePopup","openRulePopup","closeRulePopup","scrollRecord","filters","cover","str","onHide"],"mappings":";;;;;;;;;;kDAAA;;;AAGA;AACA,uH,8FAHA;AACAA,EAAE,CAACC,iCAAH,GAAuCC,mBAAvC,CAGAC,UAAU,CAACC,kBAAD,CAAV,C;;;;;;;;;;;;;ACLA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkI;AAClI;AAC6D;AACL;AACc;AACuB;;;AAG7F;AACyN;AACzN,gBAAgB,uNAAU;AAC1B,EAAE,+EAAM;AACR,EAAE,gGAAM;AACR,EAAE,yGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,oGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACxBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,+LAEN;AACP,KAAK;AACL;AACA,aAAa,uNAEN;AACP,KAAK;AACL;AACA,aAAa,+OAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACtGA;AAAA;AAAA;AAAA;AAAo3B,CAAgB,q0BAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACyHx4B,wG;;AAEA;EACAC;IACAC,kBADA;IAEAC,YAFA,EADA;;EAKAC,IALA,kBAKA;IACA;MACAC,WADA;MAEAC,cAFA;MAGAC,gBAHA,EAGA;MACAC,UAJA,EAIA;MACAC,cALA,EAKA;MACAC,UANA,EAMA;MACAC,WAPA;MAQAC,KARA,EAQA;MACAC;QACA;QACAC;QACA;UACAC,aADA;UAEAC,cAFA,EADA,CAFA;;;QAQAC,eARA,EATA;;MAmBAH,SAnBA;MAoBAI,WApBA;MAqBAC,cArBA;MAsBAC;QACA;QACAC,aAFA,EAtBA;;MA0BAC,QA1BA;MA2BAC,cA3BA;MA4BAC,iBA5BA;MA6BAC,SA7BA;;EA+BA,CArCA;EAsCAC,MAtCA,kBAsCAC,MAtCA,EAsCA;IACA;IACA;IACA;EACA,CA1CA;EA2CAC,MA3CA,oBA2CA;IACA;IACA;IACA;MACA;QACA;UACAC,gBADA;UAEAC,UAFA;;QAIAC;UACA;QACA,CAFA,EAEA,IAFA;MAGA,CARA,MAQA;QACA;UACA;UACA;QACA;MACA;IACA,CAfA;EAgBA,CA9DA;EA+DAC,+BA/DA;EAgEAC;IACAC,UADA,wBACA;MACA;IACA,CAHA,EAhEA;;EAqEAC;IACAD;MACA;QACA;QACA;QACA;MACA;IACA,CAPA,EArEA;;EA8EAE;IACAC,gBADA,4BACAzB,EADA,EACA;MACA;QACAA,MADA;;IAGA,CALA;IAMA0B,kBANA,gCAMA;MACA;QACAC,8BADA;QAEAnC;UACAoC,qBADA,EAFA;;QAKAC;UACA;YACA;UACA;QACA,CATA;;IAWA,CAlBA;IAmBAC,OAnBA,qBAmBA;MACA;QACA;QACA;MACA;MACA;MACA;QACA;UACAb,kBADA;;QAGA;MACA;MACA;QACA;UACAA,aADA;;QAGA;MACA;MACA;MACA;;MAEA;MACA;MACA;MACA;MACA;;MAEA;QACAU,uCADA;QAEAnC;UACAQ,WADA;UAEA+B,oBAFA,EAFA;;QAMAF;UACA;YACA;;YAEA;cACA;YACA,CAFA,MAEA;cACA;cACA;YACA;;YAEA;YACA;YACA;UACA,CAbA,MAaA;YACA;cACAZ,kBADA;;UAGA;QACA,CAzBA;QA0BAe;UACA;QACA,CA5BA;;IA8BA,CA5EA;IA6EAC,WA7EA,yBA6EA;MACA;QACAN,oCADA;QAEAnC;UACAQ,WADA;UAEA+B,oBAFA,EAFA;;QAMAF;UACA;YACA;YACAK;cACA;cACA;gBACA;cACA;YACA,CALA;YAMA;;YAEA;cACA;YACA;UACA,CAbA,MAaA;YACA;cACAjB,kBADA;;YAGAE;cACA;YACA,CAFA,EAEA,IAFA;UAGA;QACA,CA5BA;QA6BAa;UACA;YACAf,kBADA;;UAGAE;YACA;UACA,CAFA,EAEA,IAFA;QAGA,CApCA;;IAsCA,CApHA;IAqHAgB,SArHA,uBAqHA;MACA;QACA;MACA;MACA;QACA;MACA;MACA;QACAC;QACA;QACA;MACA;MACA;QACA;QACA;MACA,CAHA,MAGA;QACA;MACA;MACAA;MACA,oDAnBA,CAmBA;IACA,CAzIA;IA0IA;IACAC,UA3IA,wBA2IA;MACA;IACA,CA7IA;IA8IAC,UA9IA,wBA8IA;MACA;MACA;MACA;IACA,CAlJA;IAmJAC,aAnJA,2BAmJA;MACA;IACA,CArJA;IAsJAC,cAtJA,4BAsJA;MACA;IACA,CAxJA;IAyJAC,YAzJA,0BAyJA;MACA;MACAtB;QACA,iEADA,CACA;QACA;QACA;MACA,CAJA,EAIA,IAJA;IAKA,CAhKA,EA9EA;;EAgPAuB;IACAC,KADA,iBACAC,GADA,EACA;MACA;IACA,CAHA,EAhPA;;EAqPAC,MArPA,oBAqPA;IACAT;EACA,CAvPA,E;;;;;;;;;;;;;AC3HA;AAAA;AAAA;AAAA;AAAunD,CAAgB,49CAAG,EAAC,C;;;;;;;;;;;ACA3oD;AACA,OAAO,KAAU,EAAE,kBAKd;;;;;;;;;;;;;ACNL;AAAA;AAAA;AAAA;AAA2wC,CAAgB,sqCAAG,EAAC,C;;;;;;;;;;;ACA/xC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"promotionpages/game/turntable/turntable.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './promotionpages/game/turntable/turntable.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./turntable.vue?vue&type=template&id=68e1c4e6&scoped=true&\"\nvar renderjs\nimport script from \"./turntable.vue?vue&type=script&lang=js&\"\nexport * from \"./turntable.vue?vue&type=script&lang=js&\"\nimport style0 from \"./turntable.vue?vue&type=style&index=0&lang=scss&\"\nimport style1 from \"./turntable.vue?vue&type=style&index=1&id=68e1c4e6&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"68e1c4e6\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"promotionpages/game/turntable/turntable.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./turntable.vue?vue&type=template&id=68e1c4e6&scoped=true&\"","var components\ntry {\n  components = {\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"components/uni-popup/uni-popup\" */ \"@/components/uni-popup/uni-popup.vue\"\n      )\n    },\n    loadingCover: function () {\n      return import(\n        /* webpackChunkName: \"components/loading-cover/loading-cover\" */ \"@/components/loading-cover/loading-cover.vue\"\n      )\n    },\n    nsLogin: function () {\n      return import(\n        /* webpackChunkName: \"components/ns-login/ns-login\" */ \"@/components/ns-login/ns-login.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.$util.img(\"upload/uniapp/game/turntable_head.png\")\n  var g1 = _vm.$util.img(\"upload/uniapp/turntable_bg.png\")\n\n  var l0 = _vm.__map(_vm.gameInfo.award, function (item, index) {\n    var $orig = _vm.__get_orig(item)\n\n    var g2 = _vm.$util.img(item.award_img)\n    return {\n      $orig: $orig,\n      g2: g2,\n    }\n  })\n\n  var l1 =\n    _vm.gameInfo.is_show_winner && _vm.gameInfo.draw_record.length\n      ? _vm.__map(_vm.gameInfo.draw_record, function (item, index) {\n          var $orig = _vm.__get_orig(item)\n\n          var f0 = _vm._f(\"cover\")(item.member_nick_name)\n\n          return {\n            $orig: $orig,\n            f0: f0,\n          }\n        })\n      : null\n  var g3 = _vm.result.is_winning\n    ? _vm.$util.img(_vm.gameInfo.award[_vm.resultIndex].award_img)\n    : null\n  var g4 = _vm.result.is_winning\n    ? _vm.$util.img(\"upload/uniapp/game/result_yes.png\")\n    : null\n  var g5 = !_vm.result.is_winning\n    ? _vm.$util.img(\"upload/uniapp/game/result_look.png\")\n    : null\n  var g6 = !_vm.result.is_winning\n    ? _vm.$util.img(\"upload/uniapp/game/result_no.png\")\n    : null\n  var g7 = _vm.$util.img(\"upload/uniapp/game/rule_head.png\")\n  var g8 = _vm.$util.timeStampTurnTime(_vm.gameInfo.start_time)\n  var g9 = _vm.$util.timeStampTurnTime(_vm.gameInfo.end_time)\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        l0: l0,\n        l1: l1,\n        g3: g3,\n        g4: g4,\n        g5: g5,\n        g6: g6,\n        g7: g7,\n        g8: g8,\n        g9: g9,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./turntable.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./turntable.vue?vue&type=script&lang=js&\"","<template>\r\n\t<scroll-view scroll-y=\"true\" class=\"container\" :data-theme=\"themeStyle\">\r\n\t\t<view>\r\n\t\t\t<view class=\"head-wrap\">\r\n\t\t\t\t<image :src=\"$util.img('upload/uniapp/game/turntable_head.png')\" mode=\"widthFix\"></image>\r\n\t\t\t\t<view class=\"rule-mark\" @click=\"openRulePopup\">规则</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"turntable-wrap\" :style=\"{ backgroundImage: 'url(' + $util.img('upload/uniapp/turntable_bg.png') + ')' }\">\r\n\t\t\t\t<view class=\"wrap\">\r\n\t\t\t\t\t<view class=\"award-wrap\" v-for=\"(item, index) in gameInfo.award\" :key=\"index\">\r\n\t\t\t\t\t\t<view class=\"box\" :class=\"{ on: index == currentIndex }\">\r\n\t\t\t\t\t\t\t<view class=\"award-img\"><image :src=\"$util.img(item.award_img)\" mode=\"widthFix\"></image></view>\r\n\t\t\t\t\t\t\t<view class=\"award-text\">{{ item.award_name }}</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<block v-if=\"gameInfo.status == 1\">\r\n\t\t\t\t\t\t<block v-if=\"gameInfo.surplus_num > 0 || !token\">\r\n\t\t\t\t\t\t\t<view class=\"star-box\" @click=\"lottery\">\r\n\t\t\t\t\t\t\t\t<view class=\"text\">立即抽奖</view>\r\n\t\t\t\t\t\t\t\t<view class=\"tips\">{{ '消耗' + gameInfo.points + '积分' }}</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</block>\r\n\t\t\t\t\t\t<block v-else>\r\n\t\t\t\t\t\t\t<view class=\"star-box disabled\">\r\n\t\t\t\t\t\t\t\t<view class=\"text\">立即抽奖</view>\r\n\t\t\t\t\t\t\t\t<view class=\"tips\">{{ '(消耗' + gameInfo.points + '积分)' }}</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</block>\r\n\t\t\t\t\t</block>\r\n\t\t\t\t\t<block v-else-if=\"gameInfo.status == 0\">\r\n\t\t\t\t\t\t<view class=\"status-box\"><view>活动尚未开始</view></view>\r\n\t\t\t\t\t</block>\r\n\t\t\t\t\t<block v-else>\r\n\t\t\t\t\t\t<view class=\"status-box\"><view>活动已经结束</view></view>\r\n\t\t\t\t\t</block>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"remain-box\" v-if=\"gameInfo && token\">\r\n\t\t\t\t<view class=\"remain\">\r\n\t\t\t\t\t<text>今日还有{{ gameInfo.surplus_num }}次抽奖机会</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"operation-text\">\r\n\t\t\t\t<view class=\"point\">我的积分：{{ point }}</view>\r\n\t\t\t\t<view class=\"record\" @click=\"redirectToRecord(id)\">我的中奖记录</view>\r\n\t\t\t</view>\r\n\t\t\t<!-- 中奖名单 -->\r\n\t\t\t<view class=\"record-wrap\" v-if=\"gameInfo.is_show_winner && gameInfo.draw_record.length\">\r\n\t\t\t\t<view class=\"body-shade\"></view>\r\n\t\t\t\t<view class=\"head\">中奖名单</view>\r\n\t\t\t\t<view class=\"body\">\r\n\t\t\t\t\t<view class=\"wrap\" :class=\"{ animate: animate }\">\r\n\t\t\t\t\t\t<view v-for=\"(item, index) in gameInfo.draw_record\" :key=\"index\">\r\n\t\t\t\t\t\t\t<view class=\"tit\">{{ item.member_nick_name | cover }}</view>\r\n\t\t\t\t\t\t\t<view class=\"txt\">\r\n\t\t\t\t\t\t\t\t<l-time :text=\"item.create_time * 1000\"></l-time>\r\n\t\t\t\t\t\t\t\t获得 {{ item.award_name }}\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 抽奖结果 -->\r\n\t\t<uni-popup ref=\"resultPopup\" type=\"center\" :maskClick=\"false\">\r\n\t\t\t<view class=\"result-wrap\">\r\n\t\t\t\t<block v-if=\"result.is_winning\">\r\n\t\t\t\t\t<view class=\"content-wrap yes\">\r\n\t\t\t\t\t\t<image :src=\"$util.img(gameInfo.award[resultIndex].award_img)\" mode=\"widthFix\" class=\"look\"></image>\r\n\t\t\t\t\t\t<view class=\"msg\">恭喜您抽中{{ gameInfo.award[resultIndex].award_name }}</view>\r\n\t\t\t\t\t\t<view class=\"btn\" @click=\"closePopup\">继续抽奖</view>\r\n\t\t\t\t\t\t<text class=\"iconfont iconroundclose\" @click=\"closePopup\"></text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<image :src=\"$util.img('upload/uniapp/game/result_yes.png')\" mode=\"widthFix\" class=\"bg-img\"></image>\r\n\t\t\t\t</block>\r\n\t\t\t\t<block v-else>\r\n\t\t\t\t\t<view class=\"content-wrap\">\r\n\t\t\t\t\t\t<image :src=\"$util.img('upload/uniapp/game/result_look.png')\" mode=\"widthFix\" class=\"look\"></image>\r\n\t\t\t\t\t\t<view class=\"msg\">{{ gameInfo.no_winning_desc }}</view>\r\n\t\t\t\t\t\t<view class=\"btn\" @click=\"closePopup\">继续抽奖</view>\r\n\t\t\t\t\t\t<text class=\"iconfont iconroundclose\" @click=\"closePopup\"></text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<image :src=\"$util.img('upload/uniapp/game/result_no.png')\" mode=\"widthFix\" class=\"bg-img\"></image>\r\n\t\t\t\t</block>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\r\n\t\t<!-- 活动规则 -->\r\n\t\t<uni-popup ref=\"rulePopup\" type=\"center\" :maskClick=\"false\">\r\n\t\t\t<view class=\"rule-wrap\">\r\n\t\t\t\t<view class=\"content-wrap\">\r\n\t\t\t\t\t<image :src=\"$util.img('upload/uniapp/game/rule_head.png')\" mode=\"widthFix\" class=\"rule-head\"></image>\r\n\t\t\t\t\t<scroll-view scroll-y=\"true\" class=\"rule\">\r\n\t\t\t\t\t\t<view>\r\n\t\t\t\t\t\t\t<view class=\"tit\">活动时间</view>\r\n\t\t\t\t\t\t\t<view class=\"text\">{{ $util.timeStampTurnTime(gameInfo.start_time) }} - {{ $util.timeStampTurnTime(gameInfo.end_time) }}</view>\r\n\t\t\t\t\t\t\t<view class=\"tit\">参与规则</view>\r\n\t\t\t\t\t\t\t<view class=\"text\" v-if=\"gameInfo.join_type == 0\">每个用户活动期间共有{{ gameInfo.join_frequency }}次抽奖机会。</view>\r\n\t\t\t\t\t\t\t<view class=\"text\" v-else>每个用户活动期间每天都有{{ gameInfo.join_frequency }}次抽奖机会，每天0点更新。</view>\r\n\t\t\t\t\t\t\t<view class=\"text\">每次抽奖需消耗 {{ gameInfo.points }} 积分</view>\r\n\t\t\t\t\t\t\t<view class=\"text\" v-if=\"gameInfo.level_id != 0\">该活动只有{{ gameInfo.level_name }}等级的会员可参与。</view>\r\n\t\t\t\t\t\t\t<block v-if=\"gameInfo.remark != ''\">\r\n\t\t\t\t\t\t\t\t<view class=\"tit\">活动说明</view>\r\n\t\t\t\t\t\t\t\t<view class=\"text\">{{ gameInfo.remark }}</view>\r\n\t\t\t\t\t\t\t</block>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</scroll-view>\r\n\t\t\t\t\t<text class=\"iconfont iconroundclose\" @click=\"closeRulePopup\"></text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\r\n\t\t<loading-cover ref=\"loadingCover\"></loading-cover>\r\n\t\t<ns-login ref=\"login\"></ns-login>\r\n\t</scroll-view>\r\n</template>\r\n\r\n<script>\r\nimport uniPopup from '@/components/uni-popup/uni-popup.vue';\r\nimport LTime from '@/promotionpages/components/l-time/l-time.vue';\r\nimport globalConfig from '@/common/js/golbalConfig.js';\r\n\r\nexport default {\r\n\tcomponents: {\r\n\t\tuniPopup,\r\n\t\tLTime\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\ttoken: null,\r\n\t\t\tisClick: false,\r\n\t\t\tcurrentIndex: -1, // 当前选中\r\n\t\t\tmaxRing: 6, // 最大圈数,\r\n\t\t\tcurrentRing: 1, // 当前圈数\r\n\t\t\tspeed: 300, // 转数\r\n\t\t\ttimer: null,\r\n\t\t\tid: 0, // 活动id\r\n\t\t\tgameInfo: {\r\n\t\t\t\t// 游戏信息\r\n\t\t\t\taward: [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\taward_img: '',\r\n\t\t\t\t\t\taward_name: ''\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\tsurplus_num: ''\r\n\t\t\t},\r\n\t\t\taward: [],\r\n\t\t\tnoAward: [],\r\n\t\t\tresultIndex: 0,\r\n\t\t\tresult: {\r\n\t\t\t\t// 抽奖结果\r\n\t\t\t\tis_winning: 1\r\n\t\t\t},\r\n\t\t\tpoint: 0,\r\n\t\t\tanimate: false,\r\n\t\t\tscrollTimer: null,\r\n\t\t\tsiteId: 0\r\n\t\t};\r\n\t},\r\n\tonLoad(option) {\r\n\t\tif (option.id) this.id = option.id;\r\n\t\tif (option.site_id) this.siteId = option.site_id;\r\n\t\tthis.getGameInfo();\r\n\t},\r\n\tonShow() {\r\n\t\t// 刷新多语言\r\n\t\tthis.$langConfig.refresh();\r\n\t\tthis.$store.dispatch('getAddonIsexit').then(data => {\r\n\t\t\tif (!data.turntable) {\r\n\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\ttitle: '幸运抽奖未开启',\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.$util.redirectTo('/pages/index/index/index', {}, 'redirectTo');\r\n\t\t\t\t}, 1000);\r\n\t\t\t} else {\r\n\t\t\t\tif (uni.getStorageSync('token')) {\r\n\t\t\t\t\tthis.getMemberPointInfo();\r\n\t\t\t\t\tthis.token = uni.getStorageSync('token');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tmixins: [globalConfig],\r\n\tcomputed: {\r\n\t\tstoreToken() {\r\n\t\t\treturn this.$store.state.token;\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tstoreToken: function(nVal, oVal) {\r\n\t\t\tif (nVal) {\r\n\t\t\t\tthis.token = uni.getStorageSync('token');\r\n\t\t\t\tthis.getMemberPointInfo();\r\n\t\t\t\tthis.getGameInfo();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tredirectToRecord(id) {\r\n\t\t\tthis.$util.redirectTo('/promotionpages/game/record/record', {\r\n\t\t\t\tid: id\r\n\t\t\t});\r\n\t\t},\r\n\t\tgetMemberPointInfo() {\r\n\t\t\tthis.$api.sendRequest({\r\n\t\t\t\turl: '/api/memberaccount/info',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\taccount_type: 'point'\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tif (res.data) {\r\n\t\t\t\t\t\tthis.point = parseInt(res.data.point);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tlottery() {\r\n\t\t\tif (!uni.getStorageSync('token')) {\r\n\t\t\t\tthis.$refs.login.open('/promotionpages/game/turntable/turntable?id=' + this.id + '&site_id=' + this.siteId);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.gameInfo.status != 1) return;\r\n\t\t\tif (this.gameInfo.surplus_num <= 0) {\r\n\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\ttitle: '您的抽奖次数已用完'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.gameInfo.points > 0 && this.point < this.gameInfo.points) {\r\n\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\ttitle: '积分不足'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.isClick) return;\r\n\t\t\tthis.isClick = true;\r\n\r\n\t\t\t// 初始化转盘参数\r\n\t\t\tthis.currentIndex = 0;\r\n\t\t\tthis.currentRing = 1;\r\n\t\t\tthis.speed = 300;\r\n\t\t\tthis.timer = setInterval(this.startRoll, this.speed);\r\n\r\n\t\t\tthis.$api.sendRequest({\r\n\t\t\t\turl: '/turntable/api/turntable/lottery',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tid: this.id,\r\n\t\t\t\t\tsite_id: this.siteId\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tif (res.code >= 0) {\r\n\t\t\t\t\t\tthis.result = res.data;\r\n\r\n\t\t\t\t\t\tif (res.data.is_winning) {\r\n\t\t\t\t\t\t\tthis.resultIndex = this.$util.inArray(res.data.award_id, this.award);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tlet length = this.noAward.length;\r\n\t\t\t\t\t\t\tthis.resultIndex = this.noAward[Math.floor(Math.random() * length)];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// 扣除次数 积分\r\n\t\t\t\t\t\tthis.point -= this.gameInfo.points;\r\n\t\t\t\t\t\tthis.gameInfo.surplus_num -= 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\t\t\ttitle: res.message\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: res => {\r\n\t\t\t\t\tthis.resultIndex = this.$util.inArray(-1, this.award);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tgetGameInfo() {\r\n\t\t\tthis.$api.sendRequest({\r\n\t\t\t\turl: '/turntable/api/turntable/info',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tid: this.id,\r\n\t\t\t\t\tsite_id: this.siteId\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tif (res.code >= 0 && res.data) {\r\n\t\t\t\t\t\tthis.gameInfo = res.data;\r\n\t\t\t\t\t\tres.data.award.forEach((e, f) => {\r\n\t\t\t\t\t\t\tthis.award.push(e.award_id);\r\n\t\t\t\t\t\t\tif (e.award_id < 0) {\r\n\t\t\t\t\t\t\t\tthis.noAward.push(f);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tif (this.$refs.loadingCover) this.$refs.loadingCover.hide();\r\n\r\n\t\t\t\t\t\tif (this.gameInfo.is_show_winner && this.gameInfo.draw_record.length > 6) {\r\n\t\t\t\t\t\t\tthis.scrollTimer = setInterval(this.scrollRecord, 2000);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\t\t\ttitle: '未获取到活动信息！'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tthis.$util.redirectTo('/pages/index/index/index', {}, 'reLaunch');\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: res => {\r\n\t\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\t\ttitle: '未获取到活动信息！'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.$util.redirectTo('/pages/index/index/index', {}, 'reLaunch');\r\n\t\t\t\t\t}, 1000);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tstartRoll() {\r\n\t\t\tif (this.speed > 50) {\r\n\t\t\t\tthis.speed -= 50;\r\n\t\t\t}\r\n\t\t\tif (this.currentRing >= this.maxRing - 1 && this.speed < 700) {\r\n\t\t\t\tthis.speed += 100;\r\n\t\t\t}\r\n\t\t\tif (this.currentRing == this.maxRing && this.currentIndex == this.resultIndex) {\r\n\t\t\t\tclearInterval(this.timer);\r\n\t\t\t\tthis.showResult();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.currentIndex == 7) {\r\n\t\t\t\tthis.currentRing += 1;\r\n\t\t\t\tthis.currentIndex = 0;\r\n\t\t\t} else {\r\n\t\t\t\tthis.currentIndex += 1;\r\n\t\t\t}\r\n\t\t\tclearInterval(this.timer);\r\n\t\t\tthis.timer = setTimeout(this.startRoll, this.speed); //开始转动\r\n\t\t},\r\n\t\t// 展示中奖结果\r\n\t\tshowResult() {\r\n\t\t\tthis.$refs.resultPopup.open();\r\n\t\t},\r\n\t\tclosePopup() {\r\n\t\t\tthis.isClick = false;\r\n\t\t\tthis.currentIndex = -1;\r\n\t\t\tthis.$refs.resultPopup.close();\r\n\t\t},\r\n\t\topenRulePopup() {\r\n\t\t\tthis.$refs.rulePopup.open();\r\n\t\t},\r\n\t\tcloseRulePopup() {\r\n\t\t\tthis.$refs.rulePopup.close();\r\n\t\t},\r\n\t\tscrollRecord() {\r\n\t\t\tthis.animate = true;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.gameInfo.draw_record.push(this.gameInfo.draw_record[0]); // 将数组的第一个元素添加到数组的\r\n\t\t\t\tthis.gameInfo.draw_record.shift();\r\n\t\t\t\tthis.animate = false;\r\n\t\t\t}, 1000);\r\n\t\t}\r\n\t},\r\n\tfilters: {\r\n\t\tcover(str) {\r\n\t\t\treturn str.substr(0, 1) + '******' + str.substr(-1);\r\n\t\t}\r\n\t},\r\n\tonHide() {\r\n\t\tclearInterval(this.scrollTimer);\r\n\t}\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n@import '../public/css/turntable.scss';\r\n</style>\r\n<style scoped>\r\n>>> .uni-popup__wrapper.uni-custom .uni-popup__wrapper-box {\r\n\tbackground: none !important;\r\n}\r\n\r\n>>> .uni-popup__wrapper.uni-custom.center .uni-popup__wrapper-box {\r\n\toverflow: unset;\r\n}\r\n\r\n/deep/ .reward-popup .uni-popup__wrapper-box {\r\n\tbackground: none !important;\r\n\tmax-width: unset !important;\r\n\tmax-height: unset !important;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./turntable.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./turntable.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1666847649928\n      var cssReload = require(\"/Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import mod from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./turntable.vue?vue&type=style&index=1&id=68e1c4e6&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./turntable.vue?vue&type=style&index=1&id=68e1c4e6&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1666847636420\n      var cssReload = require(\"/Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}