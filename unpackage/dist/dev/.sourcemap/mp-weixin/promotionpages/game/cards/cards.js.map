{"version":3,"sources":["uni-app:///main.js","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/cards/cards.vue?954c","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/cards/cards.vue?45ba","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/cards/cards.vue?54e4","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/cards/cards.vue?345f","uni-app:///promotionpages/game/cards/cards.vue","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/cards/cards.vue?70b6","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/cards/cards.vue?6a70","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/cards/cards.vue?8a25","webpack:////Users/longchu/Documents/接单/改客服源码/promotionpages/game/cards/cards.vue?f7c0"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","components","uniPopup","LTime","data","ctxData","ctx","ctxW","ctxH","scaleRatio","showGuide","id","gameInfo","no_winning_desc","surplus_num","result","is_winning","isClick","point","animate","scrollTimer","siteId","token","popState","mixins","onLoad","option","onShow","title","mask","setTimeout","computed","storeToken","watch","methods","redirectToRecord","popChange","e","getMemberPointInfo","url","account_type","success","createCtx","touchMove","event","lottery","site_id","query","select","boundingClientRect","exec","getGameInfo","fail","openRulePopup","closeRulePopup","scrollRecord","reCards","Object","onReady","filters","cover","str","onHide","clearInterval"],"mappings":";;;;;;;;;;kDAAA;;;AAGA;AACA,2G,8FAHA;AACAA,EAAE,CAACC,iCAAH,GAAuCC,mBAAvC,CAGAC,UAAU,CAACC,cAAD,CAAV,C;;;;;;;;;;;;;ACLA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA8H;AAC9H;AACyD;AACL;AACc;AACuB;;;AAGzF;AACyN;AACzN,gBAAgB,uNAAU;AAC1B,EAAE,2EAAM;AACR,EAAE,4FAAM;AACR,EAAE,qGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,gGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACxBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA,aAAa,+LAEN;AACP,KAAK;AACL;AACA,aAAa,uNAEN;AACP,KAAK;AACL;AACA,aAAa,+OAEN;AACP,KAAK;AACL;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;AC1EA;AAAA;AAAA;AAAA;AAAg3B,CAAgB,i0BAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACqGp4B,wG;;AAEA;EACAC;IACAC,kBADA;IAEAC,YAFA,EADA;;EAKAC,IALA,kBAKA;IACA;MACAC,aADA;MAEAC,SAFA;MAGAC,OAHA;MAIAC,OAJA;MAKAC,aALA;MAMAC,eANA;MAOAC,KAPA;MAQAC;QACA;QACAC,mBAFA;QAGAC,cAHA,EARA;;MAaAC;QACA;QACAC,aAFA,EAbA;;MAiBAC,cAjBA;MAkBAC,QAlBA;MAmBAC,cAnBA;MAoBAC,iBApBA;MAqBAC,SArBA;MAsBAC,SAtBA;MAuBAC,eAvBA;;EAyBA,CA/BA;EAgCAC,+BAhCA;EAiCAC,MAjCA,kBAiCAC,MAjCA,EAiCA;IACA;IACA;IACA;EACA,CArCA;EAsCAC,MAtCA,oBAsCA;IACA;IACA;IACA;MACA;QACA;UACAC,eADA;UAEAC,UAFA;;QAIAC;UACA;QACA,CAFA,EAEA,IAFA;MAGA,CARA,MAQA;QACA;UACA;UACA;QACA;MACA;IACA,CAfA;EAgBA,CAzDA;EA0DAC;IACAC,UADA,wBACA;MACA;IACA,CAHA,EA1DA;;EA+DAC;IACAD;MACA;QACA;QACA;QACA;MACA;IACA,CAPA,EA/DA;;EAwEAE;IACAC,gBADA,4BACAxB,EADA,EACA;MACA;QACAA,MADA;;IAGA,CALA;IAMAyB,SANA,qBAMAC,CANA,EAMA;MACA;IACA,CARA;IASAC,kBATA,gCASA;MACA;QACAC,8BADA;QAEAnC;UACAoC,qBADA,EAFA;;QAKAC;UACA;YACA;UACA;QACA,CATA;;IAWA,CArBA;IAsBAC,SAtBA,uBAsBA;MACA;MACA;MACA;MACA;MACA;IACA,CA5BA;IA6BAC,SA7BA,qBA6BAC,KA7BA,EA6BA;MACAA;MACA;MACA;MACA;MACA;MACA;MACA;MACA;IACA,CAtCA;IAuCA;IACAC,OAxCA,qBAwCA;MACA;QACA;QACA;MACA;MACA;MACA;QACA;UACAjB,kBADA;;QAGA;MACA;MACA;QACA;UACAA,aADA;;QAGA;MACA;MACA;MACA;MACA;QACAW,+BADA;QAEAnC;UACAO,WADA;UAEAmC,oBAFA,EAFA;;QAMAL;UACA;YACA;YACA;;;YAGA;YACAM;YACAC,MADA,CACA,aADA;YAEAC,kBAFA,CAEA;cACA;cACA;cACA;cACA;YACA,CAPA;YAQAC,IARA;;;YAWA;YACA;YACA;UACA,CApBA,MAoBA;YACA;cACAtB,kBADA;;UAGA;QACA,CAhCA;;IAkCA,CA9FA;IA+FAuB,WA/FA,yBA+FA;MACA;QACAZ,4BADA;QAEAnC;UACA0C,oBADA;UAEAnC,WAFA,EAFA;;QAMA8B;UACA;YACA;YACA;;YAEA;cACA;YACA;UACA,CAPA,MAOA;YACA;cACAb,kBADA;;YAGAE;cACA;YACA,CAFA,EAEA,IAFA;UAGA;QACA,CAtBA;QAuBAsB;UACA;YACAxB,kBADA;;UAGAE;YACA;UACA,CAFA,EAEA,IAFA;QAGA,CA9BA;;IAgCA,CAhIA;IAiIAuB,aAjIA,2BAiIA;MACA;IACA,CAnIA;IAoIAC,cApIA,4BAoIA;MACA;IACA,CAtIA;IAuIAC,YAvIA,0BAuIA;MACA;MACAzB;QACA,iEADA,CACA;QACA;QACA;MACA,CAJA,EAIA,IAJA;IAKA,CA9IA;IA+IA0B,OA/IA,qBA+IA;MACA;MACA;QACAnD,aADA;QAEAC,SAFA;QAGAC,OAHA;QAIAC,OAJA;QAKAC,aALA;QAMAC,eANA;QAOAE;UACA;UACAC,mBAFA;UAGAC,cAHA,EAPA;;QAYAC;UACA;UACAC,aAFA,EAZA;;QAgBAC,cAhBA;QAiBAC,QAjBA;QAkBAC,cAlBA;QAmBAC,iBAnBA;;MAqBAqC;MACA;MACA;QACA;MACA;;;;;;;;;;;;;IAaA,CAvLA,EAxEA;;EAiQAC,OAjQA,qBAiQA;;;;;;;;;;;;;EAaA,CA9QA;EA+QAC;IACAC,KADA,iBACAC,GADA,EACA;MACA;IACA,CAHA,EA/QA;;EAoRAC,MApRA,oBAoRA;IACAC;EACA,CAtRA,E;;;;;;;;;;;;;ACvGA;AAAA;AAAA;AAAA;AAAmnD,CAAgB,w9CAAG,EAAC,C;;;;;;;;;;;ACAvoD;AACA,OAAO,KAAU,EAAE,kBAKd;;;;;;;;;;;;;ACNL;AAAA;AAAA;AAAA;AAAuwC,CAAgB,kqCAAG,EAAC,C;;;;;;;;;;;ACA3xC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"promotionpages/game/cards/cards.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './promotionpages/game/cards/cards.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./cards.vue?vue&type=template&id=9a12256c&scoped=true&\"\nvar renderjs\nimport script from \"./cards.vue?vue&type=script&lang=js&\"\nexport * from \"./cards.vue?vue&type=script&lang=js&\"\nimport style0 from \"./cards.vue?vue&type=style&index=0&lang=scss&\"\nimport style1 from \"./cards.vue?vue&type=style&index=1&id=9a12256c&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9a12256c\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"promotionpages/game/cards/cards.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cards.vue?vue&type=template&id=9a12256c&scoped=true&\"","var components\ntry {\n  components = {\n    uniPopup: function () {\n      return import(\n        /* webpackChunkName: \"components/uni-popup/uni-popup\" */ \"@/components/uni-popup/uni-popup.vue\"\n      )\n    },\n    loadingCover: function () {\n      return import(\n        /* webpackChunkName: \"components/loading-cover/loading-cover\" */ \"@/components/loading-cover/loading-cover.vue\"\n      )\n    },\n    nsLogin: function () {\n      return import(\n        /* webpackChunkName: \"components/ns-login/ns-login\" */ \"@/components/ns-login/ns-login.vue\"\n      )\n    },\n  }\n} catch (e) {\n  if (\n    e.message.indexOf(\"Cannot find module\") !== -1 &&\n    e.message.indexOf(\".vue\") !== -1\n  ) {\n    console.error(e.message)\n    console.error(\"1. 排查组件名称拼写是否正确\")\n    console.error(\n      \"2. 排查组件是否符合 easycom 规范，文档：https://uniapp.dcloud.net.cn/collocation/pages?id=easycom\"\n    )\n    console.error(\n      \"3. 若组件不符合 easycom 规范，需手动引入，并在 components 中注册该组件\"\n    )\n  } else {\n    throw e\n  }\n}\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.$util.img(\"upload/uniapp/game/cards_head.png\")\n  var g1 = _vm.$util.img(\"upload/uniapp/game/cards_bg.png\")\n  var l0 =\n    _vm.gameInfo.is_show_winner && _vm.gameInfo.draw_record.length\n      ? _vm.__map(_vm.gameInfo.draw_record, function (item, index) {\n          var $orig = _vm.__get_orig(item)\n\n          var f0 = _vm._f(\"cover\")(item.member_nick_name)\n\n          return {\n            $orig: $orig,\n            f0: f0,\n          }\n        })\n      : null\n  var g2 = _vm.$util.img(\"upload/uniapp/game/rule_head.png\")\n  var g3 = _vm.$util.timeStampTurnTime(_vm.gameInfo.start_time)\n  var g4 = _vm.$util.timeStampTurnTime(_vm.gameInfo.end_time)\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        l0: l0,\n        g2: g2,\n        g3: g3,\n        g4: g4,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cards.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cards.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"container\" :data-theme=\"themeStyle\">\r\n\t\t<view>\r\n\t\t\t<view class=\"head-wrap\">\r\n\t\t\t\t<image :src=\"$util.img('upload/uniapp/game/cards_head.png')\" mode=\"widthFix\"></image>\r\n\t\t\t\t<view class=\"rule-mark\" @click=\"openRulePopup\">规则</view>\r\n\t\t\t</view>\r\n\t\t\t<!-- 刮卡区域 -->\r\n\t\t\t<view class=\"prize-area\">\r\n\t\t\t\t<view class=\"content-wrap\">\r\n\t\t\t\t\t<view>\r\n\t\t\t\t\t\t<view class=\"guide-wrap\" v-if=\"showGuide\">\r\n\t\t\t\t\t\t\t<block v-if=\"gameInfo.status == 1\">\r\n\t\t\t\t\t\t\t\t<view class=\"text\">刮开试试手气</view>\r\n\t\t\t\t\t\t\t\t<view class=\"btn color-base-bg\" :class=\"{ disabled: gameInfo.surplus_num == 0 }\" @click=\"lottery\">\r\n\t\t\t\t\t\t\t\t\t点我刮奖{{ '(' + gameInfo.points + '积分)' }}\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</block>\r\n\t\t\t\t\t\t\t<block v-else-if=\"gameInfo.status == 0\"><view class=\"text\">活动尚未开始</view></block>\r\n\t\t\t\t\t\t\t<block v-else><view class=\"text\">活动已经结束</view></block>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<!-- #ifdef MP -->\r\n\t\t\t\t\t\t<view class=\"canvas-shade\" v-if=\"showGuide\"></view>\r\n\t\t\t\t\t\t<canvas :disable-scroll=\"true\" class=\"canvas\" canvas-id=\"cardsCanvas\" id=\"canvas\" @touchmove=\"touchMove\" v-show=\"!showGuide && !popState\"></canvas>\r\n\t\t\t\t\t\t<!-- #endif -->\r\n\r\n\t\t\t\t\t\t<!-- #ifdef H5 -->\r\n\t\t\t\t\t\t<canvas :disable-scroll=\"true\" class=\"canvas\" canvas-id=\"cardsCanvas\" id=\"canvas\" @touchmove=\"touchMove\"></canvas>\r\n\t\t\t\t\t\t<!-- #endif -->\r\n\t\t\t\t\t\t<view class=\"result-wrap\">\r\n\t\t\t\t\t\t\t<block v-if=\"result.is_winning\">\r\n\t\t\t\t\t\t\t\t<view class=\"title\">恭喜您中奖了</view>\r\n\t\t\t\t\t\t\t\t<view class=\"text color-base-text\">{{ result.award_name }}</view>\r\n\t\t\t\t\t\t\t\t<view class=\"tips\">可到“我的中奖记录”中查看</view>\r\n\t\t\t\t\t\t\t</block>\r\n\t\t\t\t\t\t\t<block v-else>\r\n\t\t\t\t\t\t\t\t<view class=\"text color-base-text\">{{ gameInfo.no_winning_desc }}</view>\r\n\t\t\t\t\t\t\t</block>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<image :src=\"$util.img('upload/uniapp/game/cards_bg.png')\" mode=\"widthFix\"></image>\r\n\t\t\t</view>\r\n\r\n\t\t\t<!-- 操作 -->\r\n\t\t\t<view class=\"action-text\">\r\n\t\t\t\t<view class=\"point\">我的积分：{{ point }}</view>\r\n\t\t\t\t<view class=\"record\" @click=\"redirectToRecord(id)\">我的中奖记录</view>\r\n\t\t\t</view>\r\n\t\t\t<!-- 中奖名单 -->\r\n\t\t\t<view class=\"record-wrap\" v-if=\"gameInfo.is_show_winner && gameInfo.draw_record.length\">\r\n\t\t\t\t<view class=\"body-shade\"></view>\r\n\t\t\t\t<view class=\"head\">中奖名单</view>\r\n\t\t\t\t<view class=\"body\">\r\n\t\t\t\t\t<view class=\"wrap\" :class=\"{ animate: animate }\">\r\n\t\t\t\t\t\t<view v-for=\"(item, index) in gameInfo.draw_record\" :key=\"index\">\r\n\t\t\t\t\t\t\t<view class=\"tit\">{{ item.member_nick_name | cover }}</view>\r\n\t\t\t\t\t\t\t<view class=\"txt\">\r\n\t\t\t\t\t\t\t\t<l-time :text=\"item.create_time * 1000\"></l-time>\r\n\t\t\t\t\t\t\t\t获得 {{ item.award_name }}\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 活动规则 -->\r\n\t\t<uni-popup ref=\"rulePopup\" type=\"center\" :maskClick=\"false\" @change=\"popChange\">\r\n\t\t\t<view class=\"rule-wrap\">\r\n\t\t\t\t<view class=\"content-wrap\">\r\n\t\t\t\t\t<image :src=\"$util.img('upload/uniapp/game/rule_head.png')\" mode=\"widthFix\" class=\"rule-head\"></image>\r\n\t\t\t\t\t<scroll-view scroll-y=\"true\" class=\"rule\">\r\n\t\t\t\t\t\t<view>\r\n\t\t\t\t\t\t\t<view class=\"tit\">活动时间</view>\r\n\t\t\t\t\t\t\t<view class=\"text\">{{ $util.timeStampTurnTime(gameInfo.start_time) }} - {{ $util.timeStampTurnTime(gameInfo.end_time) }}</view>\r\n\t\t\t\t\t\t\t<view class=\"tit\">参与规则</view>\r\n\t\t\t\t\t\t\t<view class=\"text\" v-if=\"gameInfo.join_type == 0\">每个用户活动期间共有{{ gameInfo.join_frequency }}次抽奖机会。</view>\r\n\t\t\t\t\t\t\t<view class=\"text\" v-else>每个用户活动期间每天都有{{ gameInfo.join_frequency }}次抽奖机会，每天0点更新。</view>\r\n\t\t\t\t\t\t\t<view class=\"text\">每次抽奖需消耗 {{ gameInfo.points }} 积分</view>\r\n\t\t\t\t\t\t\t<view class=\"text\" v-if=\"gameInfo.level_id != 0\">该活动只有{{ gameInfo.level_name }}等级的会员可参与。</view>\r\n\t\t\t\t\t\t\t<block v-if=\"gameInfo.remark != ''\">\r\n\t\t\t\t\t\t\t\t<view class=\"tit\">活动说明</view>\r\n\t\t\t\t\t\t\t\t<view class=\"text\">{{ gameInfo.remark }}</view>\r\n\t\t\t\t\t\t\t</block>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</scroll-view>\r\n\t\t\t\t\t<text class=\"iconfont iconroundclose\" @click=\"closeRulePopup\"></text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</uni-popup>\r\n\r\n\t\t<loading-cover ref=\"loadingCover\"></loading-cover>\r\n\r\n\t\t<ns-login ref=\"login\"></ns-login>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\nimport uniPopup from '@/components/uni-popup/uni-popup.vue';\r\nimport LTime from '@/promotionpages/components/l-time/l-time.vue';\r\nimport globalConfig from '@/common/js/golbalConfig.js';\r\n\r\nexport default {\r\n\tcomponents: {\r\n\t\tuniPopup,\r\n\t\tLTime\r\n\t},\r\n\tdata() {\r\n\t\treturn {\r\n\t\t\tctxData: null,\r\n\t\t\tctx: null,\r\n\t\t\tctxW: 0,\r\n\t\t\tctxH: 0,\r\n\t\t\tscaleRatio: 1,\r\n\t\t\tshowGuide: true,\r\n\t\t\tid: 0,\r\n\t\t\tgameInfo: {\r\n\t\t\t\t// 游戏数据\r\n\t\t\t\tno_winning_desc: '',\r\n\t\t\t\tsurplus_num: 0\r\n\t\t\t},\r\n\t\t\tresult: {\r\n\t\t\t\t// 抽奖结果\r\n\t\t\t\tis_winning: 0\r\n\t\t\t},\r\n\t\t\tisClick: false,\r\n\t\t\tpoint: 0,\r\n\t\t\tanimate: false,\r\n\t\t\tscrollTimer: null,\r\n\t\t\tsiteId: 0,\r\n\t\t\ttoken: '',\r\n\t\t\tpopState: false\r\n\t\t};\r\n\t},\r\n\tmixins: [globalConfig],\r\n\tonLoad(option) {\r\n\t\tif (option.id) this.id = option.id;\r\n\t\tif (option.site_id) this.siteId = option.site_id;\r\n\t\tthis.getGameInfo();\r\n\t},\r\n\tonShow() {\r\n\t\t// 刷新多语言\r\n\t\tthis.$langConfig.refresh();\r\n\t\tthis.$store.dispatch('getAddonIsexit').then(data => {\r\n\t\t\tif (!data.cards) {\r\n\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\ttitle: '刮刮乐未开启',\r\n\t\t\t\t\tmask: true\r\n\t\t\t\t});\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.$util.redirectTo('/pages/index/index/index', {}, 'redirectTo');\r\n\t\t\t\t}, 1000);\r\n\t\t\t} else {\r\n\t\t\t\tif (uni.getStorageSync('token')) {\r\n\t\t\t\t\tthis.token = uni.getStorageSync('token');\r\n\t\t\t\t\tthis.getMemberPointInfo();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\tcomputed: {\r\n\t\tstoreToken() {\r\n\t\t\treturn this.$store.state.token;\r\n\t\t}\r\n\t},\r\n\twatch: {\r\n\t\tstoreToken: function(nVal, oVal) {\r\n\t\t\tif (nVal) {\r\n\t\t\t\tthis.token = uni.getStorageSync('token');\r\n\t\t\t\tthis.getMemberPointInfo();\r\n\t\t\t\tthis.getGameInfo();\r\n\t\t\t}\r\n\t\t}\r\n\t},\r\n\tmethods: {\r\n\t\tredirectToRecord(id) {\r\n\t\t\tthis.$util.redirectTo('/promotionpages/game/record/record', {\r\n\t\t\t\tid: id\r\n\t\t\t});\r\n\t\t},\r\n\t\tpopChange(e) {\r\n\t\t\tthis.popState = e.show;\r\n\t\t},\r\n\t\tgetMemberPointInfo() {\r\n\t\t\tthis.$api.sendRequest({\r\n\t\t\t\turl: '/api/memberaccount/info',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\taccount_type: 'point'\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tif (res.data) {\r\n\t\t\t\t\t\tthis.point = parseInt(res.data.point);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tcreateCtx() {\r\n\t\t\tthis.ctx = uni.createCanvasContext('cardsCanvas', this);\r\n\t\t\tthis.ctx.setFillStyle('#e5e5e5');\r\n\t\t\tthis.ctx.fillRect(0, 0, this.ctxW, this.ctxH);\r\n\t\t\tthis.ctx.globalCompositeOperation = 'destination-out';\r\n\t\t\tthis.ctx.draw();\r\n\t\t},\r\n\t\ttouchMove(event) {\r\n\t\t\tevent.preventDefault();\r\n\t\t\tvar canvasRect = this.ctxData;\r\n\t\t\tthis.ctx.beginPath();\r\n\t\t\tthis.ctx.arc(event.touches[0].x, event.touches[0].y, 10 * this.scaleRatio, 0, Math.PI * 2);\r\n\t\t\tthis.ctx.globalCompositeOperation = 'destination-out';\r\n\t\t\tthis.ctx.setFillStyle('#fff');\r\n\t\t\tthis.ctx.fill();\r\n\t\t\tthis.ctx.draw(true);\r\n\t\t},\r\n\t\t// 抽奖\r\n\t\tlottery() {\r\n\t\t\tif (!uni.getStorageSync('token')) {\r\n\t\t\t\tthis.$refs.login.open('/promotionpages/game/cards/cards?id=' + this.id + '&site_id=' + this.siteId);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.gameInfo.status != 1) return;\r\n\t\t\tif (this.gameInfo.surplus_num <= 0) {\r\n\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\ttitle: '您的抽奖次数已用完'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.gameInfo.points > 0 && this.point < this.gameInfo.points) {\r\n\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\ttitle: '积分不足'\r\n\t\t\t\t});\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tif (this.isClick) return;\r\n\t\t\tthis.isClick = true;\r\n\t\t\tthis.$api.sendRequest({\r\n\t\t\t\turl: '/cards/api/cards/lottery',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tid: this.id,\r\n\t\t\t\t\tsite_id: this.siteId\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tif (res.code >= 0) {\r\n\t\t\t\t\t\tthis.showGuide = false;\r\n\t\t\t\t\t\tthis.result = res.data;\r\n\r\n\t\t\t\t\t\t// #ifdef MP\r\n\t\t\t\t\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t\t\t\t\tquery\r\n\t\t\t\t\t\t\t.select('.guide-wrap')\r\n\t\t\t\t\t\t\t.boundingClientRect(data => {\r\n\t\t\t\t\t\t\t\tthis.ctxData = data;\r\n\t\t\t\t\t\t\t\tthis.ctxW = data.width;\r\n\t\t\t\t\t\t\t\tthis.ctxH = data.height;\r\n\t\t\t\t\t\t\t\tthis.createCtx();\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t.exec();\r\n\t\t\t\t\t\t// #endif\r\n\r\n\t\t\t\t\t\t// 扣除次数 积分\r\n\t\t\t\t\t\tthis.point -= this.gameInfo.points;\r\n\t\t\t\t\t\tthis.gameInfo.surplus_num -= 1;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\t\t\ttitle: res.message\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\tgetGameInfo() {\r\n\t\t\tthis.$api.sendRequest({\r\n\t\t\t\turl: '/cards/api/cards/info',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tsite_id: this.siteId,\r\n\t\t\t\t\tid: this.id\r\n\t\t\t\t},\r\n\t\t\t\tsuccess: res => {\r\n\t\t\t\t\tif (res.code >= 0 && res.data) {\r\n\t\t\t\t\t\tthis.gameInfo = res.data;\r\n\t\t\t\t\t\tif (this.$refs.loadingCover) this.$refs.loadingCover.hide();\r\n\r\n\t\t\t\t\t\tif (this.gameInfo.is_show_winner && this.gameInfo.draw_record.length > 6) {\r\n\t\t\t\t\t\t\tthis.scrollTimer = setInterval(this.scrollRecord, 2000);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\t\t\ttitle: '未获取到活动信息！'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\t\tthis.$util.redirectTo('/pages/index/index/index', {}, 'reLaunch');\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tfail: res => {\r\n\t\t\t\t\tthis.$util.showToast({\r\n\t\t\t\t\t\ttitle: '未获取到活动信息！'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\t\tthis.$util.redirectTo('/pages/index/index/index', {}, 'reLaunch');\r\n\t\t\t\t\t}, 1000);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t},\r\n\t\topenRulePopup() {\r\n\t\t\tthis.$refs.rulePopup.open();\r\n\t\t},\r\n\t\tcloseRulePopup() {\r\n\t\t\tthis.$refs.rulePopup.close();\r\n\t\t},\r\n\t\tscrollRecord() {\r\n\t\t\tthis.animate = true;\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tthis.gameInfo.draw_record.push(this.gameInfo.draw_record[0]); // 将数组的第一个元素添加到数组的\r\n\t\t\t\tthis.gameInfo.draw_record.shift();\r\n\t\t\t\tthis.animate = false;\r\n\t\t\t}, 1000);\r\n\t\t},\r\n\t\treCards() {\r\n\t\t\tif (this.showGuide) return;\r\n\t\t\tlet data = {\r\n\t\t\t\tctxData: null,\r\n\t\t\t\tctx: null,\r\n\t\t\t\tctxW: 0,\r\n\t\t\t\tctxH: 0,\r\n\t\t\t\tscaleRatio: 1,\r\n\t\t\t\tshowGuide: true,\r\n\t\t\t\tgameInfo: {\r\n\t\t\t\t\t// 游戏数据\r\n\t\t\t\t\tno_winning_desc: '',\r\n\t\t\t\t\tsurplus_num: 0\r\n\t\t\t\t},\r\n\t\t\t\tresult: {\r\n\t\t\t\t\t// 抽奖结果\r\n\t\t\t\t\tis_winning: 0\r\n\t\t\t\t},\r\n\t\t\t\tisClick: false,\r\n\t\t\t\tpoint: 0,\r\n\t\t\t\tanimate: false,\r\n\t\t\t\tscrollTimer: null\r\n\t\t\t};\r\n\t\t\tObject.assign(this.$data, data);\r\n\t\t\tthis.getGameInfo();\r\n\t\t\tif (uni.getStorageSync('token')) {\r\n\t\t\t\tthis.getMemberPointInfo();\r\n\t\t\t}\r\n\t\t\t// #ifdef H5\r\n\t\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t\tquery\r\n\t\t\t\t.select('#canvas')\r\n\t\t\t\t.boundingClientRect(data => {\r\n\t\t\t\t\tthis.ctxData = data;\r\n\t\t\t\t\tthis.ctxW = data.width;\r\n\t\t\t\t\tthis.ctxH = data.height;\r\n\t\t\t\t\tthis.createCtx();\r\n\t\t\t\t})\r\n\t\t\t\t.exec();\r\n\t\t\t// #endif\r\n\t\t}\r\n\t},\r\n\tonReady() {\r\n\t\t// #ifdef H5\r\n\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\tquery\r\n\t\t\t.select('#canvas')\r\n\t\t\t.boundingClientRect(data => {\r\n\t\t\t\tthis.ctxData = data;\r\n\t\t\t\tthis.ctxW = data.width;\r\n\t\t\t\tthis.ctxH = data.height;\r\n\t\t\t\tthis.createCtx();\r\n\t\t\t})\r\n\t\t\t.exec();\r\n\t\t// #endif\r\n\t},\r\n\tfilters: {\r\n\t\tcover(str) {\r\n\t\t\treturn str.substr(0, 1) + '******' + str.substr(-1);\r\n\t\t}\r\n\t},\r\n\tonHide() {\r\n\t\tclearInterval(this.scrollTimer);\r\n\t}\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n@import '../public/css/cards.scss';\r\n</style>\r\n<style scoped>\r\n>>> .uni-popup__wrapper.uni-custom .uni-popup__wrapper-box {\r\n\tbackground: none !important;\r\n}\r\n\r\n>>> .uni-popup__wrapper.uni-custom.center .uni-popup__wrapper-box {\r\n\toverflow: unset;\r\n}\r\n\r\n/deep/ .reward-popup .uni-popup__wrapper-box {\r\n\tbackground: none !important;\r\n\tmax-width: unset !important;\r\n\tmax-height: unset !important;\r\n}\r\n</style>\r\n","import mod from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cards.vue?vue&type=style&index=0&lang=scss&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cards.vue?vue&type=style&index=0&lang=scss&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1666844730572\n      var cssReload = require(\"/Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  ","import mod from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cards.vue?vue&type=style&index=1&id=9a12256c&scoped=true&lang=css&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./cards.vue?vue&type=style&index=1&id=9a12256c&scoped=true&lang=css&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1666844716732\n      var cssReload = require(\"/Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}