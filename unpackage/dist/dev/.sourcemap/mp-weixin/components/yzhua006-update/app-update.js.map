{"version":3,"sources":["webpack:////Users/longchu/Documents/接单/改客服源码/components/yzhua006-update/app-update.vue?7bd5","webpack:////Users/longchu/Documents/接单/改客服源码/components/yzhua006-update/app-update.vue?020e","webpack:////Users/longchu/Documents/接单/改客服源码/components/yzhua006-update/app-update.vue?a35f","webpack:////Users/longchu/Documents/接单/改客服源码/components/yzhua006-update/app-update.vue?843c","uni-app:///components/yzhua006-update/app-update.vue","webpack:////Users/longchu/Documents/接单/改客服源码/components/yzhua006-update/app-update.vue?77e5","webpack:////Users/longchu/Documents/接单/改客服源码/components/yzhua006-update/app-update.vue?e4ce"],"names":["name","props","force","type","default","tabbar","data","popup_show","platform","version","need_update","downing","downstatus","update_info","os","note","schedule","downloadedSize","viewObj","created","vm","computed","lengthWidth","width","getHeight","bottom","methods","update","console","getUpdateInfo","uni","url","method","success","checkUpdate","left","height","backgroundColor","closeUpdate","plus","performSelector","nowUpdate","download_wgt","dtask","totalSize","installWgt","path","compareVersion","ov","nv","ova","nva","no","sn","nn"],"mappings":";;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAmI;AACnI;AAC8D;AACL;AACsC;;;AAG/F;AACsN;AACtN,gBAAgB,uNAAU;AAC1B,EAAE,gFAAM;AACR,EAAE,iGAAM;AACR,EAAE,0GAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,qGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACpBA;AAAA;AAAA;AAAA;AAAs2B,CAAgB,s0BAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC8C13B,O;AACA;EACAA,iBADA;EAEA;EACAC;IACAC;MACAC,aADA;MAEAC,aAFA,CAEA;IAFA,CADA;IAKAC;MACAF,aADA;MAEAC,cAFA,CAEA;IAFA,CALA,EAHA;;EAaAE,IAbA,kBAaA;IACA;MACAC,iBADA,EACA;MACAC,YAFA,EAEA;MACAC,gBAHA,EAGA;MACAC,kBAJA,EAIA;MACAC,cALA,EAKA;MACAC,aANA,EAMA;MACAC;QACAC,MADA,EACA;QACAL,WAFA,EAEA;QACAM,QAHA,CAGA;MAHA,CAPA;MAYAC,WAZA,EAYA;MACAC,iBAbA,EAaA;MACAC,aAdA,CAcA;IAdA;EAgBA,CA9BA;EA+BAC,OA/BA,qBA+BA;IACAC;EACA,CAjCA;EAkCAC;IACA;IACAC;MACA;QACAC,sCADA;;IAGA,CANA;IAOAC;MACA;MACA;QACAC;MACA;MACA;QACA,uBADA;;IAGA,CAfA,EAlCA;;EAmDAC;IACA;IACAC,MAFA,oBAEA;MACAC;;;;;;;;;;;;;;;;;IAiBA,CApBA;;IAsBA;IACAC,aAvBA,2BAuBA;MACA;MACAC;QACAC,iDADA,EACA;QACAC,aAFA;QAGAC;UACA;UACAL;UACA;;;UAGA;UACA;YACA;cACAR;cACA;YACA;UACA;;UAEA;YACA;UACA,CAFA,MAEA;YACAQ;YACAR,iBAFA,CAEA;UACA;QACA,CAvBA;;IAyBA,CAlDA;IAmDA;IACAc,WApDA,yBAoDA;MACAd,uEADA,CACA;MACA;QACAA,qBADA,CACA;QACA;UACA;UACA;UACAA;YACAK,aADA;YAEAU,WAFA;YAGAC,cAHA;YAIAb,aAJA;YAKAc,iCALA;;UAOAjB,kBAVA,CAUA;QACA;MACA;IACA,CArEA;;IAuEA;IACAkB,WAxEA,yBAwEA;MACA;QACA;QACAC;QACAC,eADA;QAEA,MAFA;MAGA,CALA,MAKA;QACApB,sBADA,CACA;QACAA,kBAFA,CAEA;MACA;IACA,CAlFA;IAmFA;IACAqB,SApFA,uBAoFA;MACA;QACA,aADA,CACA;MACA,CAFA,MAEA;QACArB,kBADA,CACA;MACA;;MAEA;QACA;QACAA,kBAFA,CAEA;MACA,CAHA,MAGA;QACA;QACAA,kBAFA,CAEA;MACA,CAHA,MAGA;QACAmB;UACAA;QACA,CAFA;MAGA;IACA,CAtGA;IAuGA;IACAG,YAxGA,0BAwGA;MACAH,uCADA,CACA;MACA;QACAP,aADA;;MAGA;;MAEA,CAFA;;MAIAW;QACA;UACA;UACAvB;UACA;YACA;cACAA;cACA;cACA;gBACAwB,2BADA,CACA;cACA;cACAxB;cACA;YACA;cACAA,6BADA,CACA;cACA,MAXA;;QAaA,CAhBA,MAgBA;UACAmB;UACAA;UACAnB;UACAA;QACA;MACA,CAvBA;MAwBAuB;IACA,CA1IA;;IA4IA;IACAE,UA7IA,sBA6IAC,IA7IA,EA6IA;MACAP,uCADA,CACA;MACAA;QACAA;QACA;QACAA;UACAA;QACA,CAFA;MAGA,CANA,EAMA;QACAA;QACA;QACAA;MACA,CAVA;IAWA,CA1JA;IA2JA;IACAQ,cA5JA,0BA4JAC,EA5JA,EA4JAC,EA5JA,EA4JA;MACA;QACA;MACA;MACA;MACAC,sBADA;MAEAC,sBAFA;MAGA;QACA;QACAC,iBADA;QAEAC,WAFA;QAGAC,iBAHA;QAIA;UACA;QACA,CAFA,MAEA;UACA;QACA;MACA;MACA;QACA;MACA,CAFA,MAEA;QACA;MACA;IACA,CAnLA,EAnDA,E;;;;;;;;;;;;;AC/CA;AAAA;AAAA;AAAA;AAAqnD,CAAgB,q/CAAG,EAAC,C;;;;;;;;;;;ACAzoD;AACA,OAAO,KAAU,EAAE,kBAKd","file":"components/yzhua006-update/app-update.js","sourcesContent":["import { render, staticRenderFns, recyclableRender, components } from \"./app-update.vue?vue&type=template&id=3f2da3cc&scoped=true&\"\nvar renderjs\nimport script from \"./app-update.vue?vue&type=script&lang=js&\"\nexport * from \"./app-update.vue?vue&type=script&lang=js&\"\nimport style0 from \"./app-update.vue?vue&type=style&index=0&id=3f2da3cc&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3f2da3cc\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"components/yzhua006-update/app-update.vue\"\nexport default component.exports","export * from \"-!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./app-update.vue?vue&type=template&id=3f2da3cc&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 =\n    !(_vm.downstatus < 1) && !_vm.schedule\n      ? (_vm.downloadedSize / 1024 / 1024).toFixed(2)\n      : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./app-update.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./app-update.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"wrap\">\r\n\t\t<view class=\"popup-bg\" :class=\"{'popup-show' : popup_show}\" :style=\"getHeight\">\r\n\t\t\t<view class=\"update-wrap\">\r\n\t\t\t\t<view class=\"update-content\">\r\n\t\t\t\t\t<view class=\"update-con-top\">\r\n\t\t\t\t\t\t<!-- 发现新版本 -->\r\n\t\t\t\t\t\t<text class=\"update-top-title\">发现新版本</text>\r\n\t\t\t\t\t\t<text class=\"update-top-version\">V{{update_info.version}}</text>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<text class=\"uodate-content\" v-if=\"downstatus < 1\">更新内容:{{update_info.note}}</text>\r\n\t\t\t\t\t<text class=\"current-version\" v-if=\"downstatus < 1\">当前版本:V{{version}}</text>\r\n\r\n\t\t\t\t\t<view class=\"update-btn\" v-if=\"downstatus < 1\">\r\n\t\t\t\t\t\t<view class=\"btn-item\" @click=\"closeUpdate\">\r\n\t\t\t\t\t\t\t<!-- 残忍拒绝 -->\r\n\t\t\t\t\t\t\t<text class=\"item-text \">残忍拒绝</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"btn-item\" @click=\"nowUpdate\">\r\n\t\t\t\t\t\t\t<!-- 立即升级 -->\r\n\t\t\t\t\t\t\t<text class=\"item-text text-bule\">立即升级</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<!-- 下载进度 -->\r\n\t\t\t\t\t<view class=\"sche-wrap\" v-else>\r\n\t\t\t\t\t\t<!-- 更新包下载中 -->\r\n\t\t\t\t\t\t<text class=\"sche-wrap-text\">更新包下载中...</text>\r\n\t\t\t\t\t\t<view class=\"sche-bg\">\r\n\t\t\t\t\t\t\t<view class=\"sche-bg-jindu\" :style=\"lengthWidth\">\r\n\t\t\t\t\t\t\t\t<view class=\"sche-bg-round\">\r\n\t\t\t\t\t\t\t\t\t<text class=\"sche-bg-round-text\" v-if=\"schedule\">{{schedule}}%</text>\r\n\t\t\t\t\t\t\t\t\t<text class=\"sche-bg-round-text\"\r\n\t\t\t\t\t\t\t\t\t\tv-else>{{(downloadedSize/1024/1024 ).toFixed(2)}}M</text>\r\n\t\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"updata-bg-img\"></view>\r\n\t\t\t\t<view class=\"updata-bg-color\"></view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\tlet vm;\r\n\texport default {\r\n\t\tname: \"appUpdate\",\r\n\t\t//@是否强制更新\r\n\t\tprops: {\r\n\t\t\tforce: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: true, //true强制更新  false非强制更新\r\n\t\t\t},\r\n\t\t\ttabbar: {\r\n\t\t\t\ttype: Boolean,\r\n\t\t\t\tdefault: false, //是否有原生tabbar组件\r\n\t\t\t}\r\n\t\t},\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tpopup_show: false, //弹窗是否显示\r\n\t\t\t\tplatform: \"\", //ios or android\r\n\t\t\t\tversion: \"1.0.0\", //当前软件版本\r\n\t\t\t\tneed_update: false, // 是否更新\r\n\t\t\t\tdowning: false, //是否下载中\r\n\t\t\t\tdownstatus: 0, //0未下载  1已开始 2已连接到资源  3已接收到数据  4下载完成\r\n\t\t\t\tupdate_info: {\r\n\t\t\t\t\tos: '', //设备系统\r\n\t\t\t\t\tversion: '', //最新版本\r\n\t\t\t\t\tnote: '', //升级说明\r\n\t\t\t\t},\r\n\t\t\t\tschedule: 0, //下载进度宽度\r\n\t\t\t\tdownloadedSize: 0, //下载大小\r\n\t\t\t\tviewObj: null, //原生遮罩view\r\n\t\t\t};\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tvm = this;\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t// 下载进度计算\r\n\t\t\tlengthWidth: function() {\r\n\t\t\t\treturn {\r\n\t\t\t\t\twidth: vm.schedule * 480 / 100 + \"rpx\"\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgetHeight: function() {\r\n\t\t\t\tlet bottom = 0;\r\n\t\t\t\tif (vm.tabbar) {\r\n\t\t\t\t\tbottom = 50;\r\n\t\t\t\t}\r\n\t\t\t\treturn {\r\n\t\t\t\t\t\"bottom\": bottom + 'px'\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 检查更新\r\n\t\t\tupdate() {\r\n\t\t\t\tconsole.log('父组件触发方法');\r\n\t\t\t\t// #ifdef APP-PLUS\r\n\t\t\t\t// 获取手机系统信息\r\n\t\t\t\tuni.getSystemInfo({\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tvm.platform = res.platform //ios  or android\r\n\t\t\t\t\t\tconsole.log('手机系统信息', vm.platform);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// 获取版本号\r\n\t\t\t\tplus.runtime.getProperty(plus.runtime.appid, function(inf) {\r\n\t\t\t\t\tvm.version = inf.version\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log('当前版本', vm.version);\r\n\t\t\t\tvm.getUpdateInfo(); //获取更新信息\r\n\t\t\t\t// #endif\r\n\t\t\t},\r\n\r\n\t\t\t// 获取线上版本信息\r\n\t\t\tgetUpdateInfo() {\r\n\t\t\t\t//向后台发起请求，获取最新版本号\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: 'https://jhg.ruanjiangc.com/api/help/update', //仅为示例，并非真实接口地址。\r\n\t\t\t\t\tmethod: 'get',\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\t// 这里的返回的数据跟后台约定\r\n\t\t\t\t\t\tconsole.log(res.data.data)  \r\n\t\t\t\t\t\tlet data =res.data.data\r\n\r\n\r\n\t\t\t\t\t\t// 循环获取当前设备对应的更新数据\r\n\t\t\t\t\t\tfor (let i = 0; i < data.length; i++) {\r\n\t\t\t\t\t\t\tif (vm.platform == data[i]['os']) {\r\n\t\t\t\t\t\t\t\tvm.update_info = data[i];\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (!vm.update_info.os) {\r\n\t\t\t\t\t\t\t// 后台未配置当前系统的升级数据\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.log('后台返回的当前系统的升级参数', vm.update_info);\r\n\t\t\t\t\t\t\tvm.checkUpdate(); ///检查是否更新\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 检查是否更新\r\n\t\t\tcheckUpdate() {\r\n\t\t\t\tvm.need_update = vm.compareVersion(vm.version, vm.update_info.version); // 检查是否需要升级\r\n\t\t\t\tif (vm.need_update) {\r\n\t\t\t\t\tvm.popup_show = true; //线上版本号大于当前安装的版本号  显示升级框\r\n\t\t\t\t\tif (vm.tabbar) {\r\n\t\t\t\t\t\t//页面是否有原生tabbar组件\r\n\t\t\t\t\t\t// 创建原生view用来遮罩tabbar的点击事件 (如果是没有用原生的tabbar这一步可以取消)\r\n\t\t\t\t\t\tvm.viewObj = new plus.nativeObj.View('viewObj', {\r\n\t\t\t\t\t\t\tbottom: '0px',\r\n\t\t\t\t\t\t\tleft: '0px',\r\n\t\t\t\t\t\t\theight: '50px',\r\n\t\t\t\t\t\t\twidth: '100%',\r\n\t\t\t\t\t\t\tbackgroundColor: \"rgba(0,0,0,.6)\"\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tvm.viewObj.show() //显示原生遮罩\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\r\n\t\t\t// 取消更新\r\n\t\t\tcloseUpdate() {\r\n\t\t\t\tif (vm.force) {\r\n\t\t\t\t\t// 强制更新，取消退出app\r\n\t\t\t\t\tplus.os.name == \"Android\" ? plus.runtime.quit() : plus.ios.import(\"UIApplication\").sharedApplication()\r\n\t\t\t\t\t\t.performSelector(\r\n\t\t\t\t\t\t\t\"exit\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvm.popup_show = false; //关闭升级弹窗\r\n\t\t\t\t\tvm.viewObj.hide() //隐藏原生遮罩\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 立即更新\r\n\t\t\tnowUpdate() {\r\n\t\t\t\tif (vm.downing) {\r\n\t\t\t\t\treturn false //如果正在下载就停止操作\r\n\t\t\t\t} else {\r\n\t\t\t\t\tvm.downing = true; //状态改变 正在下载中\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (/\\.apk$/.test(vm.update_info.download_url)) {\r\n\t\t\t\t\t// 如果是apk地址\r\n\t\t\t\t\tvm.download_wgt() // 安装包/升级包更新\r\n\t\t\t\t} else if (/\\.wgt$/.test(vm.update_info.download_url)) {\r\n\t\t\t\t\t// 如果是更新包\r\n\t\t\t\t\tvm.download_wgt() // 安装包/升级包更新\r\n\t\t\t\t} else {\r\n\t\t\t\t\tplus.runtime.openURL(vm.update_info.download_url, function() { //调用外部浏览器打开更新地址\r\n\t\t\t\t\t\tplus.nativeUI.toast(\"打开错误\");\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 下载升级资源包\r\n\t\t\tdownload_wgt() {\r\n\t\t\t\tplus.nativeUI.showWaiting(\"下载更新文件...\"); //下载更新文件...\r\n\t\t\t\tlet options = {\r\n\t\t\t\t\tmethod: \"get\"\r\n\t\t\t\t};\r\n\t\t\t\tlet dtask = plus.downloader.createDownload(vm.update_info.download_url, options, function(d, status) {\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tdtask.addEventListener(\"statechanged\", function(task, status) {\r\n\t\t\t\t\tif (status === null) {} else if (status == 200) {\r\n\t\t\t\t\t\t//在这里打印会不停的执行，请注意，正式上线切记不要在这里打印东西///////////////////////////////////////////////////\r\n\t\t\t\t\t\tvm.downstatus = task.state;\r\n\t\t\t\t\t\tswitch (task.state) {\r\n\t\t\t\t\t\t\tcase 3: // 已接收到数据  \r\n\t\t\t\t\t\t\t\tvm.downloadedSize = task.downloadedSize;\r\n\t\t\t\t\t\t\t\tlet totalSize = 0;\r\n\t\t\t\t\t\t\t\tif (task.totalSize) {\r\n\t\t\t\t\t\t\t\t\ttotalSize = task.totalSize //服务器须返回正确的content-length才会有长度\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tvm.schedule = parseInt(100 * task.downloadedSize / totalSize);\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\tcase 4:\r\n\t\t\t\t\t\t\t\tvm.installWgt(task.filename); // 安装wgt包  \r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tplus.nativeUI.closeWaiting();\r\n\t\t\t\t\t\tplus.nativeUI.toast(\"下载出错\");\r\n\t\t\t\t\t\tvm.downing = false;\r\n\t\t\t\t\t\tvm.downstatus = 0;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tdtask.start();\r\n\t\t\t},\r\n\r\n\t\t\t// 安装文件\r\n\t\t\tinstallWgt(path) {\r\n\t\t\t\tplus.nativeUI.showWaiting(\"安装更新文件...\"); //安装更新文件...\r\n\t\t\t\tplus.runtime.install(path, {}, function() {\r\n\t\t\t\t\tplus.nativeUI.closeWaiting();\r\n\t\t\t\t\t// 应用资源下载完成！\r\n\t\t\t\t\tplus.nativeUI.alert(\"应用资源下载完成！\", function() {\r\n\t\t\t\t\t\tplus.runtime.restart();\r\n\t\t\t\t\t});\r\n\t\t\t\t}, function(e) {\r\n\t\t\t\t\tplus.nativeUI.closeWaiting();\r\n\t\t\t\t\t// 安装更新文件失败\r\n\t\t\t\t\tplus.nativeUI.alert(\"安装更新文件失败[\" + e.code + \"]：\" + e.message);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t// 对比版本号\r\n\t\t\tcompareVersion(ov, nv) {\r\n\t\t\t\tif (!ov || !nv || ov == \"\" || nv == \"\") {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t\tlet b = false,\r\n\t\t\t\t\tova = ov.split(\".\", 4),\r\n\t\t\t\t\tnva = nv.split(\".\", 4);\r\n\t\t\t\tfor (let i = 0; i < ova.length && i < nva.length; i++) {\r\n\t\t\t\t\tlet so = ova[i],\r\n\t\t\t\t\t\tno = parseInt(so),\r\n\t\t\t\t\t\tsn = nva[i],\r\n\t\t\t\t\t\tnn = parseInt(sn);\r\n\t\t\t\t\tif (nn > no || sn.length > so.length) {\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t} else if (nn < no) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (nva.length > ova.length && 0 == nv.indexOf(ov)) {\r\n\t\t\t\t\treturn true;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.popup-bg {\r\n\t\tdisplay: flex;\r\n\t\talign-items: center;\r\n\t\tjustify-content: center;\r\n\t\tposition: fixed;\r\n\t\tz-index: -9999;\r\n\t\topacity: 0;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\tright: 0;\r\n\t\tbottom: 0;\r\n\t\twidth: 750rpx;\r\n\t\tbackground-color: rgba(0, 0, 0, .6);\r\n\t\ttransition: opacity 300ms;\r\n\t}\r\n\r\n\t.popup-show {\r\n\t\tz-index: 99;\r\n\t\topacity: 1;\r\n\t}\r\n\r\n\t.update-wrap {\r\n\t\twidth: 580rpx;\r\n\t\tborder-radius: 10rpx;\r\n\t\tposition: relative;\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\toverflow: hidden;\r\n\r\n\t\t.updata-bg-img {\r\n\t\t\tposition: absolute;\r\n\t\t\ttop: 0vw;\r\n\t\t\tleft: 0px;\r\n\t\t\twidth: 580rpx;\r\n\t\t\theight: 440rpx;\r\n\t\t\tbackground: url(\"http://caihuo2020.oss-cn-beijing.aliyuncs.com/app/update-img.png\") no-repeat;\r\n\t\t\tbackground-size: 100% 100%;\r\n\t\t\tz-index: 1;\r\n\t\t}\r\n\r\n\t\t.updata-bg-color {\r\n\t\t\tposition: absolute;\r\n\t\t\twidth: 580rpx;\r\n\t\t\ttop: 10vw;\r\n\t\t\theight: calc(100% - 10vw);\r\n\t\t\tbackground-color: #ffffff;\r\n\t\t\tz-index: 0;\r\n\t\t}\r\n\r\n\t\t.update-content {\r\n\t\t\tposition: relative;\r\n\t\t\tz-index: 2;\r\n\t\t\tdisplay: flex;\r\n\t\t\tflex-direction: column;\r\n\t\t}\r\n\r\n\t\t.update-con-top {\r\n\t\t\tpadding: 70rpx 50rpx;\r\n\t\t}\r\n\r\n\t\t.update-btn {\r\n\t\t\theight: 80rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tborder-top: 1px solid #e7e7e7;\r\n\t\t\tmargin-top: 20rpx;\r\n\r\n\t\t\t.btn-item {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center;\r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\tflex: 1;\r\n\r\n\t\t\t\t.item-text {\r\n\t\t\t\t\ttext-align: center;\r\n\t\t\t\t\tfont-size: 28rpx;\r\n\t\t\t\t\tcolor: #666;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.text-bule {\r\n\t\t\t\t\tcolor: #045FCF;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.btn-item:first-child {\r\n\t\t\t\tborder-right: 1px solid #e7e7e7\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.update-top-title {\r\n\t\t\tcolor: #fff;\r\n\t\t\tfont-size: 34rpx;\r\n\t\t\tfont-weight: bold;\r\n\t\t}\r\n\r\n\t\t.update-top-version {\r\n\t\t\tcolor: #fff;\r\n\t\t\tfont-size: 28rpx;\r\n\t\t\tmargin-top: 10rpx;\r\n\t\t}\r\n\r\n\t\t.uodate-content {\r\n\t\t\tcolor: #333;\r\n\t\t\tfont-size: 30rpx;\r\n\t\t\tpadding: 0px 50rpx;\r\n\t\t\tmargin-top: 120rpx;\r\n\t\t}\r\n\r\n\t\t.current-version {\r\n\t\t\ttext-align: center;\r\n\t\t\tmargin-top: 20rpx;\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #666;\r\n\t\t\tmargin-bottom: 16rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t.sche-wrap {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\talign-items: center;\r\n\t\tjustify-content: flex-end;\r\n\t\tpadding: 160rpx 50rpx 40rpx;\r\n\r\n\t\t.sche-wrap-text {\r\n\t\t\tfont-size: 24rpx;\r\n\t\t\tcolor: #666;\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t}\r\n\r\n\t\t.sche-bg {\r\n\t\t\tposition: relative;\r\n\t\t\tbackground-color: #ccc;\r\n\t\t\theight: 20rpx;\r\n\t\t\tborder-radius: 100px;\r\n\t\t\twidth: 480rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\talign-items: center;\r\n\t\t\tmargin-bottom: 30rpx;\r\n\t\t}\r\n\r\n\t\t.sche-bg-jindu {\r\n\t\t\tposition: absolute;\r\n\t\t\tleft: 0;\r\n\t\t\ttop: 0;\r\n\t\t\theight: 20rpx;\r\n\t\t\tbackground-color: #5775e7;\r\n\t\t\tborder-radius: 100px;\r\n\r\n\t\t\t.sche-bg-round {\r\n\t\t\t\tposition: absolute;\r\n\t\t\t\tleft: 100%;\r\n\t\t\t\theight: 24rpx;\r\n\t\t\t\twidth: 24rpx;\r\n\t\t\t\tbackground-color: #fff;\r\n\t\t\t\tborder-color: #fff;\r\n\t\t\t\tborder-style: solid;\r\n\t\t\t\tborder-width: 10rpx;\r\n\t\t\t\tborder-radius: 100px;\r\n\t\t\t\ttransform: translateX(-20rpx) translateY(-10rpx);\r\n\t\t\t\tbox-shadow: 0 0 4px #eaeaea;\r\n\r\n\t\t\t\t.sche-bg-round-text {\r\n\t\t\t\t\tposition: relative;\r\n\t\t\t\t\ttop: 24rpx;\r\n\t\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\t\ttext-align: center;\r\n\t\t\t\t\tcolor: #5775e7;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n</style>\r\n","import mod from \"-!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./app-update.vue?vue&type=style&index=0&id=3f2da3cc&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../../Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./app-update.vue?vue&type=style&index=0&id=3f2da3cc&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1666847652547\n      var cssReload = require(\"/Applications/HBuilderX-Alpha.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}